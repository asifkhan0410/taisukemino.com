---
title: Uniswapã§Etherã¨ERC20ãƒˆãƒ¼ã‚¯ãƒ³ã‚’äº¤æ›ã™ã‚‹åˆ†æ•£å‹ã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦ã¿ã‚‹
description: ã¯ã˜ã‚ã«
date: '2019-10-03T16:53:38.951Z'
keywords: []
slug: >-
  /@taisukemino/uniswap-jp
language: jp
translations: [ "en", "uniswap" ]
---

![](https://cdn-images-1.medium.com/max/800/1*mQ33qO60_0YqAyYNU0Ao9g.png)

### **ã¯ã˜ã‚ã«**

ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã¯ã€èª°ã‚‚ãŒä½¿ãˆã¦èª°ã‚‚æ”¯é…ã—ãªã„ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãªå°å¸³ã‚’æ­´å²ä¸Šåˆã‚ã¦å®Ÿç¾ã—ã¾ã—ãŸã€‚ã—ã‹ã—ã€å®Ÿéš›ã«ã¯å¤šãã®ä¸­å¤®é›†æ¨©çš„ãªäº¤æ›æ‰€ãŒãƒãƒƒã‚·ãƒ¥ãƒ‘ãƒ¯ãƒ¼ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚­ãƒ¼ã‚’æ”¯é…ã—ã¦ã„ã‚‹ã®ãŒç¾çŠ¶ã§ã™ã€‚ä¸­å¤®é›†æ¨©çš„ãªäº¤æ›æ‰€ã¯æ³•å®šé€šè²¨ã¨æš—å·é€šè²¨ã‚’äº¤æ›ã™ã‚‹ã®ã«ã¯ä¸å¯æ¬ ãªã®ã§ã™ãŒã€ãã®å­˜åœ¨ã¯å½“åˆã®ãƒ“ãƒƒãƒˆã‚³ã‚¤ãƒ³ã®å“²å­¦ã¨ã¯åã—ã¦ã„ã¾ã™ã€‚ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã¯ã€ä¼šç¤¾ã‚„æ”¿åºœãªã©ã®æ©Ÿé–¢ã‹ã‚‰ã€å€‹äººã¸ã¨åŠ›ã‚’ç§»è¡Œã•ã›ã‚‹æŠ€è¡“ã®ã¯ãšã§ã—ãŸã€‚

ã©ã†ã™ã‚Œã°æœ¬æ¥ã®å“²å­¦ã«æˆ»ã‚Šã€å€‹äººã«åŠ›ã‚’ç§»ã›ã‚‹ã®ã‹ã€‚ãã®ãŸã‚ã«åˆ†æ•£å‹ãªãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ä¸€ã¤ã¨ã—ã¦å–å¼•æ‰€ã®é–‹ç™ºãŒã™ã§ã«é€²ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ãã®ä¸­ã§åƒ•ãŒæ³¨ç›®ã—ã¦ã„ã‚‹ã®ãŒã€Uniswapã¨ã„ã†äº¤æ›ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã™ã€‚åˆ†æ•£å‹å–å¼•æ‰€ã¯å®Ÿè£…ã«ã‚ˆã£ã¦ã©ã®ç¨‹åº¦åˆ†æ•£çš„ã§ã‚ã‚‹ã‹ãŒç•°ãªã‚Šã¾ã™ãŒã€åƒ•ãŒUniswapã«æ³¨ç›®ã—ã¦ã„ã‚‹ã®ã¯ã€éå¸¸ã«åˆ†æ•£çš„ã§ã‚ã‚ŠãªãŒã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ãŒå„ªã‚Œã¦ã„ã‚‹ã‹ã‚‰ã§ã™ã€‚

æ—¢å­˜ã®ä»•çµ„ã¿ã‚’ä»£æ›¿ã™ã‚‹ã«ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½¿ã„ãŸã„ã¨æ€ã†ã€ã‚ˆã‚Šã„ã„ã‚µãƒ¼ãƒ“ã‚¹ã‚’å‰µã‚‹ã—ã‹ç„¡ã„ã§ã—ã‚‡ã†ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã§ã‚ã‚Œã°ã€ã“ã‚Œã¯ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã€ãƒ¢ãƒã‚’å‰µã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚ã“ã®è¨˜äº‹ã§ã¯ã€ã¾ã•ã«ãã‚Œã‚’ã‚„ã‚Šã¾ã™ã€‚å…·ä½“çš„ã«ã¯ã€etherã¨ERC20ãƒˆãƒ¼ã‚¯ãƒ³ã‚’äº¤æ›ã™ã‚‹ç°¡å˜ãªã‚¢ãƒ—ãƒªã‚’ä½œã‚Šã¾ã™ã€‚ã“ã®è¨˜äº‹ã‚’èª­ã¿çµ‚ã‚ã‚‹é ƒã«ã¯ã€Uniswapãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ã£ã¦dappã‚„ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã®ãªã‹ã§etherã¨ERC20ãƒˆãƒ¼ã‚¯ãƒ³ã‚’äº¤æ›ã™ã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ã¾ãšã¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ä»•çµ„ã¿ã‚’ç°¡å˜ã«èª¬æ˜ã—ã¦ã‹ã‚‰ã€ã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦ã„ãã¾ã™ã€‚

### **Uniswapã®ç°¡å˜ãªèª¬æ˜**

Uniswapã¯ã€etherã¨ERC20ãƒˆãƒ¼ã‚¯ãƒ³ã®ãŸã‚ã®åˆ†æ•£çš„ãªäº¤æ›ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã™ã€‚äº¤æ›ã®ãƒ—ãƒ­ã‚»ã‚¹ã¯å…¨ã¦ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ä¸Šã§è¡Œã‚ã‚Œã€èª°ã‚‚é–“ã«ä»‹å…¥ã—ã¾ã›ã‚“ã€‚ç¬¬ä¸‰è€…ãŒä»‹å…¥ã—ãªã„ä»£ã‚ã‚Šã«ã€ãã‚Œãã‚Œã®ERC20ãƒˆãƒ¼ã‚¯ãƒ³ã”ã¨ã«åˆ¥ã€…ã®ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã®äº¤æ›ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¯ã€etherã¨ç‰¹å®šã®ERC20ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å‚™ãˆã¦ã„ã¾ã™ã€‚ãƒˆãƒ¬ãƒ¼ãƒ€ãƒ¼ã¯ã“ã®è²¯è“„ã‚’ä½¿ã£ã¦ã„ã¤ã§ã‚‚äº¤æ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚etherã‚’ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã«é€ã‚Œã°ç‰¹å®šã®ERC20ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã€é€†ã«ç‰¹å®šã®ERC20ãƒˆãƒ¼ã‚¯ãƒ³ã‚’é€ã‚Œã°etherã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®è²¯è“„ã¯ãƒªã‚¯ã‚¤ãƒ‡ã‚£ãƒ†ã‚£ãƒ»ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã«ã‚ˆã£ã¦è²¯ã‚ã‚‰ã‚Œã€å½¼ã‚‰ã¯è¦‹è¿”ã‚Šã¨ã—ã¦æ‰‹æ•°æ–™ã‚’äº¤æ›ãŒè¡Œã‚ã‚Œã‚‹ã”ã¨ã«å–ã‚Šã¾ã™ã€‚ãƒªã‚¯ã‚¤ãƒ‡ã‚£ãƒ†ã‚£ã¨ã„ã†ã®ã¯æµå‹•æ€§ã®ã“ã¨ã§ã€etherã¨ERC20ãƒˆãƒ¼ã‚¯ãƒ³ã®æµå‹•æ€§ã‚’æä¾›ã™ã‚‹ã®ã§ãƒªã‚¯ã‚¤ãƒ‡ã‚£ãƒ†ã‚£ãƒ»ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¨å‘¼ã°ã‚Œã¾ã™ã€‚ERC20ãƒˆãƒ¼ã‚¯ãƒ³åŒå£«ã‚’äº¤æ›ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

äº¤æ›ã™ã‚‹ã¨ãã®ä¾¡æ ¼ã¯ã€[Constant Product Market Maker Model](https://github.com/runtimeverification/verified-smart-contracts/blob/uniswap/uniswap/x-y-k.pdf)ã¨ã„ã†ä¾¡æ ¼è¨­å®šã®å¼ã«ã‚ˆã£ã¦è‡ªå‹•ã§æ±ºã‚ã‚‰ã‚Œã¾ã™ã€‚äº¤æ›ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆå†…ã®etherã®é‡ã¨ERC20ãƒˆãƒ¼ã‚¯ãƒ³ã®é‡ãŒå¸¸ã«ä¸€å®šã«ãªã‚‹ã‚ˆã†ã«ä¾¡æ ¼ãŒè¨ˆç®—ã•ã‚Œã¾ã™ã€‚ã“ã®å¼ã¯ERC20ãƒˆãƒ¼ã‚¯ãƒ³åŒå£«ã®äº¤æ›ã§ã‚‚åŒæ§˜ã«é©å¿œã•ã‚Œã€äº¤æ›ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆå†…ã®ERC20ãƒˆãƒ¼ã‚¯ãƒ³Aã®é‡ã¨ERC20ãƒˆãƒ¼ã‚¯ãƒ³Bã®é‡ãŒå¸¸ã«ä¸€å®šã«ãªã‚‹ã‚ˆã†ã«ä¾¡æ ¼ãŒè¨ˆç®—ã•ã‚Œã¾ã™ã€‚

ä¾‹ãˆã°ã€DAIã¨ã„ã†ERC20ãƒˆãƒ¼ã‚¯ãƒ³ã®äº¤æ›ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã«`10ETH`ã¨`1000DAI`ãŒå…¥ã£ã¦ã„ã‚‹ã¨ã—ã¾ã™ã€‚ã“ã“ã§å®šæ•°ã¯ `10 x 1000`ã§`10000`ã¨ãªã‚Šã¾ã™ã€‚æ¬¡ã«ã“ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã«`1ETH`é€ã‚‹ã¨ã€ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¯`11ETH`æŒã¤ã“ã¨ã«ãªã‚Šã¾ã™ã€‚ETHã®é‡ã¨DAIã®é‡ã‚’ã‹ã‘ãŸå€¤ã¯å¸¸ã«`10000`ã§ä¸€å®šã§ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‚ã¤ã¾ã‚ŠDAIã¯`10000 Ã· 11 â‰’ 909DAI`ãªã‘ã‚Œã°ã„ã‘ãªã„ã¨ã„ã†ã“ã¨ã§ã™ã€‚é€†ã«ã„ãˆã°ã€ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¯`1000DAI`æŒã£ã¦ã„ã‚‹å¿…è¦ã¯ãªã„ã®ã§ã€`1000 â€“ 909 = 91DAI`ãŒãƒˆãƒ¬ãƒ¼ãƒ€ãƒ¼ã«æ¸¡ã•ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

ã“ã®å¼ã¯åˆ¥å `x * y = k` å¼ã¨ã‚‚å‘¼ã°ã‚Œã€xã¨yã®å€¤ã«ã‚ˆã£ã¦ä»¥ä¸‹ã®ã‚ˆã†ãªæ›²ç·šã‚’æãã¾ã™ã€‚

![x * y = kÂ curve](https://cdn-images-1.medium.com/max/800/1*c3NH7TYQN7qvs-UheOQ2HQ.png)  
x * y = kÂ curve

UniswapãŒç´ æ™´ã‚‰ã—ã„ã®ã¯ã€è²¯è“„ã‚·ã‚¹ãƒ†ãƒ ã¨è‡ªå‹•è¨ˆç®—å¼ã«ã‚ˆã£ã¦å£²ã‚Šæ‰‹ã¨è²·ã„æ‰‹ã‚’ãƒãƒƒãƒã™ã‚‹ã‚³ã‚¹ãƒˆã‚’æ¸›ã‚‰ã—ãŸã“ã¨ã«ã‚ã‚Šã¾ã™ã€‚ã“ã®ãŠã‹ã’ã§ãƒˆãƒ¬ãƒ¼ãƒ€ãƒ¼ã¯ç°¡å˜ã‹ã¤è¿…é€Ÿã«äº¤æ›ã‚’ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### **ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**

ã§ã¯æ—©é€Ÿã‚¢ãƒ—ãƒªã‚’ä½œã‚‹ãŸã‚ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã«é€²ã¿ã¾ã™ï¼ã“ã‚Œã‹ã‚‰ä½œã‚‹ã‚¢ãƒ—ãƒªã¯ã€etherã¨daiã‚’äº¤æ›ã§ãã‚‹ç°¡å˜ãªNodeJSã®ã‚¢ãƒ—ãƒªã§ã™ã€‚

GitHubã§[ãƒ¬ãƒã‚¸ãƒˆãƒª](https://github.com/icovo/eht-uniswap-demo)ã‚’ä½œã£ãŸã®ã§ã€å…ˆã«è»½ãç›®ã‚’é€šã—ã¦ãŠãã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚åœ°å›³ã‚’æŒã£ã¦ã„ã‚‹ã¨é“ã‚’é€²ã¿ã‚„ã™ã„ã®ã¨åŒã˜ã§ã€æœ€çµ‚çš„ã«ã©ã†ã„ã†ã‚³ãƒ¼ãƒ‰ã«ãªã‚‹ã®ã‹ã‚ã‹ã£ãŸæ–¹ãŒã€ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒæ¥½ã«ãªã‚Šã¾ã™ã€‚åƒ•ãŒä½¿ã£ã¦ã„ã‚‹OSã¯macOS High Sierraã§ã™ã€‚

**ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚­ãƒ¼ã¨ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å–å¾—**  
[vanity-eth](https://vanity-eth.tk/)ã‹ã‚‰ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚­ãƒ¼ã¨ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–ã£ã¦ãã¦ãã ã•ã„ã€‚Generateãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ä¸€ç•ªä¸‹ã«ç”Ÿæˆã•ã‚ŒãŸãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚­ãƒ¼ã¨ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå‡ºã¦ãã¾ã™ã€‚å®‰å…¨ã§ã¯ãªã„ã®ã§ã€ãƒ†ã‚¹ãƒˆç›®çš„ä»¥å¤–ã§ä½¿ã‚ãªã„ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚

**Rinkebyãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆã®etherã‚’æ‰‹ã«å…¥ã‚Œã‚‹**  
Rinkebyã®etherã‚’æŒã£ã¦ã„ãªã„äººã¯ã€[faucet](https://faucet.rinkeby.io/)ã‹ã‚‰å–ã£ã¦ãã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ„ã‚¤ãƒ¼ãƒˆã—ã¦ã€
```
Requesting faucet funds into YOUR_ADDRESS_HERE on the #Rinkeby #Ethereum test network.
```
ã“ã®ãƒ„ã‚¤ãƒ¼ãƒˆã®ãƒªãƒ³ã‚¯ã‚’ãƒ•ã‚©ãƒ¼ãƒ ã«è²¼ã‚Šä»˜ã‘ã‚‹ã¨ã‚‚ã‚‰ãˆã¾ã™ã€‚æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆã¯å‹é”ã«ãŠé¡˜ã„ã™ã‚‹ã‹ã€ã‚‚ã—ãã¯[@taisuke\_mino\_JP](https://twitter.com/taisuke_mino_JP)ã«ãƒ„ã‚¤ãƒ¼ãƒˆã—ã¦ã„ãŸã ã‘ã‚Œã°å°‘ã—ã¯äºˆå‚™ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

æ®‹é«˜ã¯[Rinkeby Etherscan](https://rinkeby.etherscan.io/)ã§ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ¤œç´¢ã—ã¦ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚0.1ETHã‚ã‚Œã°ååˆ†ã§ã™ã€‚

**Npmã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚‹**
```
mkdir eht-uniswap-demo  
cd eht-uniswap-demo/  
npm init --yes
```
\*npmã¨nodejsãŒå…¥ã£ã¦ã„ãªã„æ–¹ã¯[ã“ã¡ã‚‰](https://nodejs.org/en/)ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚

**gitã‚’initializeã™ã‚‹**
```
git init
```
**web3ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹**
```
npm i --save web3@1.2.1
```
web3ã¯Ethereumã®JavaScript APIã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™ã€‚ãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆã‚’å«ã‚ãŸEthereumã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã™ã€‚JavaScriptã®ã‚¢ãƒ—ãƒªã‹ã‚‰Ethereumã®ãƒãƒ¼ãƒ‰ã¨ã‚„ã‚Šã¨ã‚Šã—ãŸã‚Šã€ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ä¸Šã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ã‚‹ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¨ã‚„ã‚Šã¨ã‚Šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

**Infuraã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å–å¾—**  
Ethereumã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ã‚„ã‚Šã¨ã‚Šã™ã‚‹ãŸã‚ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¨ã—ã¦[Infura](https://infura.io/)ã‚’ä½¿ã„ã¾ã™ã€‚Infuraã«ç™»éŒ²ã—ã¦æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã£ã¦ã‹ã‚‰Rinkebyãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å–å¾—ã—ã¦ãã ã•ã„ã€‚URLã¯ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«ãªã‚Šã¾ã™ã€‚
```
https://rinkeby.infura.io/v3/YOUR_PROJECT_ID
```
**ethereumjs-txãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹**
```
npm i --save ethereumjs-tx@1.3.7
```
ethereumjs-txã¯ã€ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆã—ãŸã‚Šã€ã‚µã‚¤ãƒ³ã™ã‚‹ã®ã«ä½¿ã„ã¾ã™ã€‚

### **ETHã‹ã‚‰DAIã¸ã®äº¤æ›**

ã§ã¯ã“ã“ã‹ã‚‰ã¯ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚

**ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ**  
[EthToDaiRinkeby.mjs](https://github.com/icovo/eht-uniswap-demo/blob/master/EthToDaiRinkeby.mjs)ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚mjsã¯ã€ES6ã®æ–‡æ³•ã§æ›¸ããŸã‚ã®æ‹¡å¼µå­ã§ã™ã€‚

**ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ**
```
import Web3 from "web3";  
import EthTx from "ethereumjs-tx";
```
**äº¤æ›ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨abiã‚’å®£è¨€**  
Rinkebyãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆä¸Šã®DAIã®äº¤æ›ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã¨abiã‚’å®£è¨€ã—ã¾ã™ã€‚[ã“ã¡ã‚‰](https://hackmd.io/SHPZJPSUTSW8se71CP_TBA)ã®ãƒªãƒ³ã‚¯ã‹ã‚‰å¼•ã£å¼µã£ã¦ãã¦ã„ã¾ã™ã€‚ã“ã®å®šæ•°ã¯ã€ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¨ã‚„ã‚Šã¨ã‚Šã™ã‚‹ä¸Šã§å¿…è¦ã«ãªã‚Šã¾ã™ã€‚

äº¤æ›ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹:
```
const daiExchangeAddress = "0x77dB9C915809e7BE439D2AB21032B1b8B58F6891";
```
\*[Etherscan](https://rinkeby.etherscan.io/address/0x77dB9C915809e7BE439D2AB21032B1b8B58F6891)ã§ã‚‚è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

äº¤æ›ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆabi:
```
const daiExchangeAbi = '[{â€œnameâ€: â€œTokenPurchaseâ€, â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œbuyerâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œeth_soldâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_boughtâ€, â€œindexedâ€: true}], â€œanonymousâ€: false, â€œtypeâ€: â€œeventâ€}, {â€œnameâ€: â€œEthPurchaseâ€, â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œbuyerâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_soldâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œeth_boughtâ€, â€œindexedâ€: true}], â€œanonymousâ€: false, â€œtypeâ€: â€œeventâ€}, {â€œnameâ€: â€œAddLiquidityâ€, â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œproviderâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œeth_amountâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtoken_amountâ€, â€œindexedâ€: true}], â€œanonymousâ€: false, â€œtypeâ€: â€œeventâ€}, {â€œnameâ€: â€œRemoveLiquidityâ€, â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œproviderâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œeth_amountâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtoken_amountâ€, â€œindexedâ€: true}], â€œanonymousâ€: false, â€œtypeâ€: â€œeventâ€}, {â€œnameâ€: â€œTransferâ€, â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_fromâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_toâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œ_valueâ€, â€œindexedâ€: false}], â€œanonymousâ€: false, â€œtypeâ€: â€œeventâ€}, {â€œnameâ€: â€œApprovalâ€, â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_ownerâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_spenderâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œ_valueâ€, â€œindexedâ€: false}], â€œanonymousâ€: false, â€œtypeâ€: â€œeventâ€}, {â€œnameâ€: â€œsetupâ€, â€œoutputsâ€: [], â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œtoken_addrâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 175875}, {â€œnameâ€: â€œaddLiquidityâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_liquidityâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmax_tokensâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}], â€œconstantâ€: false, â€œpayableâ€: true, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 82605}, {â€œnameâ€: â€œremoveLiquidityâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œamountâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_ethâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_tokensâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 116814}, {â€œnameâ€: â€œ__default__â€, â€œoutputsâ€: [], â€œinputsâ€: [], â€œconstantâ€: false, â€œpayableâ€: true, â€œtypeâ€: â€œfunctionâ€}, {â€œnameâ€: â€œethToTokenSwapInputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_tokensâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}], â€œconstantâ€: false, â€œpayableâ€: true, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 12757}, {â€œnameâ€: â€œethToTokenTransferInputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_tokensâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œrecipientâ€}], â€œconstantâ€: false, â€œpayableâ€: true, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 12965}, {â€œnameâ€: â€œethToTokenSwapOutputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}], â€œconstantâ€: false, â€œpayableâ€: true, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 50463}, {â€œnameâ€: â€œethToTokenTransferOutputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œrecipientâ€}], â€œconstantâ€: false, â€œpayableâ€: true, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 50671}, {â€œnameâ€: â€œtokenToEthSwapInputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_soldâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_ethâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 47503}, {â€œnameâ€: â€œtokenToEthTransferInputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_soldâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_ethâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œrecipientâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 47712}, {â€œnameâ€: â€œtokenToEthSwapOutputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œeth_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmax_tokensâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 50175}, {â€œnameâ€: â€œtokenToEthTransferOutputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œeth_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmax_tokensâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œrecipientâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 50384}, {â€œnameâ€: â€œtokenToTokenSwapInputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_soldâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_tokens_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_eth_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œtoken_addrâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 51007}, {â€œnameâ€: â€œtokenToTokenTransferInputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_soldâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_tokens_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_eth_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œrecipientâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œtoken_addrâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 51098}, {â€œnameâ€: â€œtokenToTokenSwapOutputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmax_tokens_soldâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmax_eth_soldâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œtoken_addrâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 54928}, {â€œnameâ€: â€œtokenToTokenTransferOutputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmax_tokens_soldâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmax_eth_soldâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œrecipientâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œtoken_addrâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 55019}, {â€œnameâ€: â€œtokenToExchangeSwapInputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_soldâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_tokens_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_eth_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œexchange_addrâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 49342}, {â€œnameâ€: â€œtokenToExchangeTransferInputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_soldâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_tokens_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmin_eth_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œrecipientâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œexchange_addrâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 49532}, {â€œnameâ€: â€œtokenToExchangeSwapOutputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmax_tokens_soldâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmax_eth_soldâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œexchange_addrâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 53233}, {â€œnameâ€: â€œtokenToExchangeTransferOutputâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_boughtâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmax_tokens_soldâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œmax_eth_soldâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œdeadlineâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œrecipientâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œexchange_addrâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 53423}, {â€œnameâ€: â€œgetEthToTokenInputPriceâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œeth_soldâ€}], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 5542}, {â€œnameâ€: â€œgetEthToTokenOutputPriceâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_boughtâ€}], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 6872}, {â€œnameâ€: â€œgetTokenToEthInputPriceâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œtokens_soldâ€}], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 5637}, {â€œnameâ€: â€œgetTokenToEthOutputPriceâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œeth_boughtâ€}], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 6897}, {â€œnameâ€: â€œtokenAddressâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 1413}, {â€œnameâ€: â€œfactoryAddressâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 1443}, {â€œnameâ€: â€œbalanceOfâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_ownerâ€}], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 1645}, {â€œnameâ€: â€œtransferâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œboolâ€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_toâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œ_valueâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 75034}, {â€œnameâ€: â€œtransferFromâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œboolâ€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_fromâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_toâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œ_valueâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 110907}, {â€œnameâ€: â€œapproveâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œboolâ€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_spenderâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œ_valueâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 38769}, {â€œnameâ€: â€œallowanceâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_ownerâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_spenderâ€}], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 1925}, {â€œnameâ€: â€œnameâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œbytes32â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 1623}, {â€œnameâ€: â€œsymbolâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œbytes32â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 1653}, {â€œnameâ€: â€œdecimalsâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 1683}, {â€œnameâ€: â€œtotalSupplyâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 1713}]';
```
**ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚­ãƒ¼ã®å®šæ•°å®£è¨€**
```
const addressFrom = "[YOUR_ADDRESS]";  
const privKey = "[YOUR_PRIVATE_KEY]";
```
**Web3ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**  
Infuraã‚’web3ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¨ã—ã¦ä½¿ã†ãŸã‚ã«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚
```
const web3 = new Web3(  
  new Web3.providers.HttpProvider("https://rinkeby.infura.io/v3/[YOUR_PROJECT_ID]"  
  )  
);
```
**ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–**  
web3ã®`Contract`ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨abiã‚’æ¸¡ã—ã¦ã€ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã—ã¾ã™ã€‚
```
const daiExchangeContract = new web3.eth.Contract(JSON.parse(daiExchangeAbi), daiExchangeAddress);
```
ã“ã‚Œã§daiäº¤æ›ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®é–¢æ•°ã‚’å‘¼ã‚“ã§etherã¨daiã‚’äº¤æ›ã™ã‚‹æº–å‚™ãŒã§ãã¾ã—ãŸã€‚

`ETH_SOLD`**å®šæ•°å®£è¨€**  
daiã¨äº¤æ›ã—ãŸã„ETHã®é‡ã‚’ã‚‚ã¤å®šæ•°ã‚’å®£è¨€ã—ã¾ã™ã€‚
```
const ETH_SOLD = web3.utils.toHex(50000000000000000); // 0.05ETH
```
`ethToTokenSwapInput`**é–¢æ•°ã®abiã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰**  
ethã‚’daiã¨äº¤æ›ã™ã‚‹ã®ã«ã€[ethToTokenSwapInput](https://docs.uniswap.io/smart-contract-integration/interface#exchange-interface)é–¢æ•°ã‚’ä½¿ã„ã¾ã™ã€‚
```
function ethToTokenSwapInput(uint256 min_tokens, uint256 deadline) external payable returns (uint256 tokens_bought);
```
`min_tokens`_ã¨_`deadline`ã‚’å¼•æ•°ã«ã¨ã‚Šã¾ã™ã€‚`min_tokens`ã§ã¯è³¼å…¥ã™ã‚‹daiã®æœ€ä½é¡ã‚’æŒ‡å®šã—ã¾ã™ã€‚`deadline`ã§ã¯ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®æœŸé™ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã¤ã¾ã‚ŠæœŸé™ä»¥å†…ã«å®Ÿè¡Œã•ã‚Œãªã‹ã£ãŸãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯å¤±æ•—ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

ã“ã‚Œã‚‰ã®å¼•æ•°ã¯ãƒ•ãƒ­ãƒ³ãƒˆãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ã‚’æŠ‘æ­¢ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚ä»®ã«`1ETH`ã‚’äº¤æ›ã™ã‚‹æ™‚ã®ä¾¡æ ¼ãŒ`200DAI`ã ã¨ã—ã¾ã—ã‚‡ã†ã€‚`199DAI`ä»¥ä¸‹ã—ã‹ã‚‚ã‚‰ãˆãªã„å ´åˆã«ã¯ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå¤±æ•—ã™ã‚‹ã‚ˆã†ã«æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€ãƒ•ãƒ­ãƒ³ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ãŒä¾¡æ ¼ã‚’æ“ä½œã—ãŸã¨ã—ã¦ã‚‚å¤§æã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã¾ãŸæœŸé™ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€ãƒ•ãƒ­ãƒ³ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ãŒåˆ©ç›Šã‚’å¾—ã‚‹ãŸã‚ã«ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æŒã¡ç¶šã‘ã‚‹ã“ã¨ã‚’æŠ‘åˆ¶ã§ãã¾ã™ã€‚ãƒ•ãƒ­ãƒ³ãƒˆãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ã«ã¤ã„ã¦ã¯[ã“ã¡ã‚‰ã®æŠ•ç¨¿](https://ethresear.ch/t/improving-front-running-resistance-of-x-y-k-market-makers/1281)ãŒè©³ã—ã„ã§ã™ã€‚

`min_tokens`å¼•æ•°ã«æ¸¡ã™ãŸã‚ã®å®šæ•°ã‚’å®£è¨€ã—ã¾ã™ã€‚
```
const MIN_TOKENS = web3.utils.toHex(0.2 * 10 ** 18); // 0.2 DAI
```
å€¤ãŒä½ã™ãã‚‹ã¨ãƒ•ãƒ­ãƒ³ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ã«ç°¡å˜ã«åˆ©ç›Šã‚’å–ã‚‰ã‚Œã¦ã—ã¾ã„ã€é€†ã«é«˜ã™ãã‚‹ã¨ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå¤±æ•—ã—ã‚„ã™ã„ã®ã§ã€ãƒãƒ©ãƒ³ã‚¹ã‚’è€ƒãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

`deadline`å¼•æ•°ã«æ¸¡ã™åˆ¥ã®å®šæ•°ã‚’å®£è¨€ã—ã¾ã™ã€‚ä»¥ä¸‹ã®å€¤ã¯ã€UTCæ™‚é–“2019å¹´10æœˆ1æ—¥åˆå‰12:00ã®Unixã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã§ã™ã€‚ã™ã§ã«ä»¥ä¸‹ã®æ—¥æ™‚ã‚’éãã¦ã—ã¾ã£ã¦ã„ã‚‹å ´åˆã¯ã€ã“ã¡ã‚‰ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã®[ã‚³ãƒ³ãƒãƒ¼ã‚¿ãƒ¼](https://www.unixtimestamp.com/index.php)ã‚’ä½¿ã£ã¦ãã ã•ã„ã€‚
```
const DEADLINE = 1569888000; // 10/01/2019 @ 12:00am (UTC)
```
æ¬¡ã«`ethToTokenSwapInput`é–¢æ•°ã«ï¼’ã¤ã®å€¤ã‚’æ¸¡ã—ã€abiã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
```
const exchangeEncodedABI = daiExchangeContract.methods.ethToTokenSwapInput(MIN_TOKENS, DEADLINE).encodeABI();
```
`sendSignedTx`**é–¢æ•°ã®å®£è¨€**  
ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚µã‚¤ãƒ³ã—ã¦ã€ãã‚Œã‚’Ethereumãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆã™ã‚‹é–¢æ•°ã‚’å®£è¨€ã—ã¾ã™ã€‚
```
function sendSignedTx(transactionObject, cb) {  
  let transaction = new EthTx(transactionObject);  
  const privateKey = new Buffer.from(privKey, "hex");  
  transaction.sign(privateKey);  
  const serializedEthTx = transaction.serialize().toString("hex");  
  web3.eth.sendSignedTransaction(`0x${serializedEthTx}`, cb);  
}
```
**ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€**`sendSignedTx`**é–¢æ•°ã‚’å®Ÿè¡Œ**
```
web3.eth.getTransactionCount(addressFrom).then(transactionNonce => {  
  const transactionObject = {  
    chainId: 4,  
    nonce: web3.utils.toHex(transactionNonce),  
    gasLimit: web3.utils.toHex(6000000),  
    gasPrice: web3.utils.toHex(10000000000),  
    to: daiExchangeAddress,  
    from: addressFrom,  
    data: exchangeEncodedABI,  
    value: ETH_SOLD  
  };

sendSignedTx(transactionObject, function(error, result){  
    if(error) return console.log("error ===>", error);  
    console.log("sent ===>", result);  
  })  
}  
);
```
`exchangeEncodedABI`ã¨`ETH_SOLD`ã‚’ãã‚Œãã‚Œ`data`ã¨`value`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«æ¸¡ã—ã¦ã„ã¾ã™ã€‚

**ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èµ°ã‚‰ã›ã‚‹**
```
npm run eth-to-dai-rinkeby
```
`0xbbc617c97323301d7376683a0ae58db012b418f27963e54866eb92bec4839e10`ã®ã‚ˆã†ãªãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒƒã‚·ãƒ¥ã‚’å—ã‘å–ã£ãŸã‚‰ã€etherscanã§è©³ç´°ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã¯åƒ•ã®ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ä¾‹ã§ã™ã€‚

![[https://rinkeby.etherscan.io/tx/0xbbc617c97323301d7376683a0ae58db012b418f27963e54866eb92bec4839e10](https://rinkeby.etherscan.io/tx/0xbbc617c97323301d7376683a0ae58db012b418f27963e54866eb92bec4839e10)](https://cdn-images-1.medium.com/max/800/1*-HfsdMtYZ9ms_WotpvYWWw.png)
[https://rinkeby.etherscan.io/tx/0xbbc617c97323301d7376683a0ae58db012b418f27963e54866eb92bec4839e10](https://rinkeby.etherscan.io/tx/0xbbc617c97323301d7376683a0ae58db012b418f27963e54866eb92bec4839e10)

ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒæˆåŠŸã—ã¦ã„ã‚Œã°ã€ã€ŒErc20 Token Txnsã€ã¨ã„ã†ã‚¿ãƒ–ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰è‡ªåˆ†ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã«daiãŒå…¥ã£ã¦ã„ã‚‹ã“ã¨ãŒ[ç¢ºèªã§ãã‚‹](https://rinkeby.etherscan.io/address/0xd0633f104cbb4f6631268f2f73ea428715253517#tokentxns)ã¯ãšã§ã™ã€‚

![](https://cdn-images-1.medium.com/max/800/1*5xBy06QU9M1bFNu4r7XPNQ.png)

ã“ã‚Œã§Ethã¨Daiã‚’äº¤æ›ã§ãã¾ã—ãŸï¼

### **DAIã‹ã‚‰ETHã¸ã®äº¤æ›**

æ¬¡ã«DAIã‹ã‚‰ETHã«äº¤æ›ã—ã¾ã™ã€‚ä»Šå›ã¯å°‘ã—ãƒˆãƒªãƒƒã‚­ãƒ¼ã§ã€ï¼’ã¤ã®ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚ã¾ãšæœ€åˆã«Uniswapã®daiäº¤æ›ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã«è‡ªåˆ†ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ä»£ã‚ã£ã¦daiã‚’é€ã‚‹è¨±å¯ã‚’ä¸ãˆã¾ã™ã€‚æ¬¡ã«`tokenToEthSwapInput`é–¢æ•°ã‚’å‘¼ã‚“ã§Daiã‚’Ethã¨äº¤æ›ã—ã¾ã™ã€‚

#### **1\. Uniswapã®DAIäº¤æ›ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã«è¨±å¯ã‚’ä¸ãˆã‚‹**

åˆ¥ã®_approveDaiExchangeRinkeby.mjs_ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚Šã¾ã™ã€‚ä»Šå›ã¯å‰ã®ã‚³ãƒ¼ãƒ‰ã¨é‡è¤‡ã—ã¦ã„ã‚‹éƒ¨åˆ†ã¯çœãã¾ã™ã€‚æœ€çµ‚çš„ãªã‚³ãƒ¼ãƒ‰ã¯[ã“ã¡ã‚‰](https://github.com/icovo/eht-uniswap-demo/blob/master/approveDaiExchangeRinkeby.mjs)ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

**ãƒˆãƒ¼ã‚¯ãƒ³ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨abiã‚’å®£è¨€**

Rinkebyãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆã§ã®daiã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨abiã‚’å®£è¨€ã—ã¾ã™ã€‚

ãƒˆãƒ¼ã‚¯ãƒ³ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹:
```
const daiTokenAddress = â€œ0x2448eE2641d78CC42D7AD76498917359D961A783â€;
```
\*[Etherscan](https://rinkeby.etherscan.io/address/0x77dB9C915809e7BE439D2AB21032B1b8B58F6891)ã§ã‚‚ç¢ºèªã§ãã¾ã™ã€‚

ãƒˆãƒ¼ã‚¯ãƒ³ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆabi:
```
const daiTokenAbi = â€˜[{â€œnameâ€: â€œTransferâ€, â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_fromâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_toâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œ_valueâ€, â€œindexedâ€: false}], â€œanonymousâ€: false, â€œtypeâ€: â€œeventâ€}, {â€œnameâ€: â€œApprovalâ€, â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_ownerâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_spenderâ€, â€œindexedâ€: true}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œ_valueâ€, â€œindexedâ€: false}], â€œanonymousâ€: false, â€œtypeâ€: â€œeventâ€}, {â€œoutputsâ€: [], â€œinputsâ€: [{â€œtypeâ€: â€œstringâ€, â€œnameâ€: â€œ_nameâ€}, {â€œtypeâ€: â€œstringâ€, â€œnameâ€: â€œ_symbolâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œ_decimalsâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œ_supplyâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œconstructorâ€}, {â€œnameâ€: â€œtransferâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œboolâ€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_toâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œ_valueâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 74020}, {â€œnameâ€: â€œtransferFromâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œboolâ€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_fromâ€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_toâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œ_valueâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 110371}, {â€œnameâ€: â€œapproveâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œboolâ€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œ_spenderâ€}, {â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œ_valueâ€}], â€œconstantâ€: false, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 37755}, {â€œnameâ€: â€œnameâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œstringâ€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 6402}, {â€œnameâ€: â€œsymbolâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œstringâ€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 6432}, {â€œnameâ€: â€œdecimalsâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 663}, {â€œnameâ€: â€œtotalSupplyâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 693}, {â€œnameâ€: â€œbalanceOfâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œarg0â€}], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 877}, {â€œnameâ€: â€œallowanceâ€, â€œoutputsâ€: [{â€œtypeâ€: â€œuint256â€, â€œnameâ€: â€œoutâ€}], â€œinputsâ€: [{â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œarg0â€}, {â€œtypeâ€: â€œaddressâ€, â€œnameâ€: â€œarg1â€}], â€œconstantâ€: true, â€œpayableâ€: false, â€œtypeâ€: â€œfunctionâ€, â€œgasâ€: 1061}]â€™;
```
\*ERC20ãƒˆãƒ¼ã‚¯ãƒ³ã®abiã¯daiä»¥å¤–ã®ãƒˆãƒ¼ã‚¯ãƒ³ã§ã‚‚å…¨ã¦åŒã˜ã§ã™ã€‚

**daiExchangeAddresså®šæ•°ã®å®£è¨€**
```
const daiExchangeAddress = â€œ0x77dB9C915809e7BE439D2AB21032B1b8B58F6891â€;
```
ã“ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã«daiã‚’è‡ªåˆ†ã®ä»£ã‚ã‚Šã«é€é‡‘ã™ã‚‹è¨±å¯ã‚’ä¸ãˆã¾ã™ã€‚

**daiãƒˆãƒ¼ã‚¯ãƒ³ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–**
```
const daiTokenContract = new web3.eth.Contract(  
  JSON.parse(daiTokenAbi),  
  daiTokenAddress  
);
```
`approve`**é–¢æ•°ã«æ¸¡ã™å®šæ•°ã®å®£è¨€**
```
const ADDRESS_SPENDER = daiExchangeAddress;  
const TOKENS = web3.utils.toHex(1 * 10 ** 18); // 1 DAI
```
`daiExchangeAddress`ã«1DAIã‚’é€ã‚‹è¨±å¯ã‚’ä¸ãˆã¾ã™ã€‚

`approve`**é–¢æ•°ã®abiã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰**
```
const approveEncodedABI = daiTokenContract.methods  
  .approve(ADDRESS_SPENDER, TOKENS)  
  .encodeABI();
```
`sendSignedTx`**é–¢æ•°ã®å®£è¨€**  
ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚µã‚¤ãƒ³ã—ã€ãã‚Œã‚’Ethereunãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆã™ã‚‹é–¢æ•°ã‚’ä½œæˆ
```
function sendSignedTx(transactionObject, cb) {  
  let transaction = new EthTx(transactionObject);  
  const privateKey = new Buffer.from(privKey, "hex");  
  transaction.sign(privateKey);  
  const serializedEthTx = transaction.serialize().toString("hex");  
  web3.eth.sendSignedTransaction(`0x${serializedEthTx}`, cb);  
}
```
**ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€**`sendSignedTx`**é–¢æ•°ã‚’å®Ÿè¡Œ**
```
web3.eth.getTransactionCount(addressFrom).then(transactionNonce => {  
  const transactionObject = {  
    chainId: 4,  
    nonce: web3.utils.toHex(transactionNonce),  
    gasLimit: web3.utils.toHex(42000),  
    gasPrice: web3.utils.toHex(5000000),  
    to: daiTokenAddress,  
    from: addressFrom,  
    data: approveEncodedABI  
  };

sendSignedTx(transactionObject, function(error, result){  
    if(error) return console.log("error ===>", error);  
    console.log("sent ===>", result);  
  })  
}  
);
```
**ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èµ°ã‚‰ã›ã‚‹**
```
npm run approve-dai-exchange-rinkeby
```
`0x1d16e0ccb3947ecbd34e16f9ae9378a17b16e11c701f1d0f44e5262d0e8f018a`ã®ã‚ˆã†ãªãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒƒã‚·ãƒ¥ã‚’å—ã‘å–ã£ãŸã‚‰ã€etherscanã§è©³ç´°ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã¯åƒ•ã®ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ä¾‹ã§ã™ã€‚

![[https://rinkeby.etherscan.io/tx/0x1d16e0ccb3947ecbd34e16f9ae9378a17b16e11c701f1d0f44e5262d0e8f018a](https://rinkeby.etherscan.io/tx/0x1d16e0ccb3947ecbd34e16f9ae9378a17b16e11c701f1d0f44e5262d0e8f018a)](https://cdn-images-1.medium.com/max/800/1*qOPbrK-eXphyaBV_qoajnQ.png)
[https://rinkeby.etherscan.io/tx/0x1d16e0ccb3947ecbd34e16f9ae9378a17b16e11c701f1d0f44e5262d0e8f018a](https://rinkeby.etherscan.io/tx/0x1d16e0ccb3947ecbd34e16f9ae9378a17b16e11c701f1d0f44e5262d0e8f018a)

#### 2\. **DAIã‚’ETHã«äº¤æ›ã™ã‚‹**

æ¬¡ã«å®Ÿéš›ã«DAIã‚’ETHã«äº¤æ›ã™ã‚‹éƒ¨åˆ†ã‚’å®Ÿè£…ã—ã¾ã™ã€‚ä»Šå›ã‚‚å‰ã®ã‚³ãƒ¼ãƒ‰ã¨é‡è¤‡ã—ã¦ã„ã‚‹éƒ¨åˆ†ã¯çœãã¾ã™ã€‚[DaiToEthRinkeby.mjs](https://github.com/icovo/eht-uniswap-demo/blob/master/DaiToEthRinkeby.mjs)ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚Šã€[tokenToEthSwapInput](https://docs.uniswap.io/smart-contract-integration/interface#exchange-interface)é–¢æ•°ã‚’å‘¼ã³ã¾ã™ã€‚
```
function tokenToEthSwapInput(uint256 tokens_sold, uint256 min_eth, uint256 deadline) external returns (uint256 eth_bought);
```
ã“ã®é–¢æ•°ã¯å¼•æ•°ã‚’ï¼“ã¤ã¨ã‚Šã¾ã™ã€‚`tokens_sold` ã¯äº¤æ›ã™ã‚‹ERC20ãƒˆãƒ¼ã‚¯ãƒ³ã®é‡ã§ã™ã€‚`min_eth`ã¯äº¤æ›ã™ã‚‹ETHã®æœ€ä½é¡ã§ã™ã€‚`deadline`ã¯ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®æœŸé™ã§ã™ã€‚
```
const TOKENS_SOLD = web3.utils.toHex(0.4 * 10 ** 18); // 0.4DAI  
const MIN_ETH = web3.utils.toHex(5000000000000000); // 0.005ETH  
const DEADLINE = 1569888000; // 10/01/2019 @ 12:00am (UTC)
```
`tokenToEthSwapInput`é–¢æ•°ã«ï¼“ã¤ã®å®šæ•°ã‚’å¼•æ•°ã¨ã—ã¦æ¸¡ã—ã€abiã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
```
const tokenToEthEncodedABI = daiExchangeContract.methods  
  .tokenToEthSwapInput(TOKENS_SOLD, MIN_ETH, DEADLINE)  
  .encodeABI();
```
ã“ã®`tokenToEthEncodedABI`ã‚’ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®`data`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«æ¸¡ã—ã¾ã™ã€‚

ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èµ°ã‚‰ã›ã¾ã™ã€‚
```
npm run dai-to-eth-rinkeby
```
`0x6011a9f50b80dba7a2cb3f9dbf327f0f4c28ec6a4205c2b4002b3a008aa480f4`ã®ã‚ˆã†ãªãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒƒã‚·ãƒ¥ã‚’å—ã‘å–ã£ãŸã‚‰ã€etherscanã§ãã®è©³ç´°ã‚’ç¢ºèªã§ãã¾ã™ã€‚ä»¥ä¸‹ã¯åƒ•ã®ãƒˆãƒ©ãƒ³ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ä¾‹ã§ã™ã€‚

![[https://rinkeby.etherscan.io/tx/0x6011a9f50b80dba7a2cb3f9dbf327f0f4c28ec6a4205c2b4002b3a008aa480f4](https://rinkeby.etherscan.io/tx/0x6011a9f50b80dba7a2cb3f9dbf327f0f4c28ec6a4205c2b4002b3a008aa480f4)](https://cdn-images-1.medium.com/max/800/1*hv9CEzIin3jT4624x2NOZw.png)
[https://rinkeby.etherscan.io/tx/0x6011a9f50b80dba7a2cb3f9dbf327f0f4c28ec6a4205c2b4002b3a008aa480f4](https://rinkeby.etherscan.io/tx/0x6011a9f50b80dba7a2cb3f9dbf327f0f4c28ec6a4205c2b4002b3a008aa480f4)

ä»¥ä¸‹ã®ã‚ˆã†ã«DAIãŒè‡ªåˆ†ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰[å¼•ã‹ã‚Œ](https://rinkeby.etherscan.io/address/0xd0633f104cbb4f6631268f2f73ea428715253517#tokentxns)ã€

![](https://cdn-images-1.medium.com/max/800/1*vXN1hC4fZbDtkb0E2PSC6Q.png)

ETHãŒ[è¿½åŠ ã•ã‚Œã¦ã„ã‚‹](https://rinkeby.etherscan.io/address/0xd0633f104cbb4f6631268f2f73ea428715253517#internaltx)ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

![](https://cdn-images-1.medium.com/max/800/1*-SxIygP8zm6U_OFqOyFy1Q.png)

DAIä»¥å¤–ã®ä»–ã®ERC20ãƒˆãƒ¼ã‚¯ãƒ³ã‚’äº¤æ›ã—ãŸã„å ´åˆã¯ã€ãƒˆãƒ¼ã‚¯ãƒ³ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å¤‰ãˆã‚‹ã ã‘ã§å®Ÿè£…ã§ãã¾ã™ã€‚

ã“ã®è¨˜äº‹ãŒã¾ã ã“ã“ã«ãªã„ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œã‚‹ä¸€åŠ©ã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚ğŸ˜
